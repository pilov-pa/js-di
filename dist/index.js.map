{"version":3,"sources":["../src/index.js"],"names":["Service","name","className","args","shared","DI","services","Error","service","compiled","resolvedArgs","arg","resolvedArg","resolve","push","result","Reflect","construct"],"mappings":";;;;;;;;;;;;;;;IAAMA,O,GAOF,iBAAYC,IAAZ,EAAkBC,SAAlB,EACA;AAAA,MAD6BC,IAC7B,uEADoC,EACpC;AAAA,MADwCC,MACxC,uEADiD,IACjD;;AAAA;;AAAA;;AAAA;;AAAA,kCALS,IAKT;;AAAA,gCAJO,EAIP;;AAAA,oCAHW,IAGX;;AACI,OAAKA,MAAL,GAAcA,MAAd;AACA,OAAKH,IAAL,GAAYA,IAAZ;AACA,OAAKC,SAAL,GAAiBA,SAAjB;AACA,OAAKC,IAAL,GAAYA,IAAZ;AACH,C;;IAEgBE,E;;;;;;sCACN,E;;;;;wBAEPJ,I,EAAMC,S,EAAqC;AAAA,UAA1BC,IAA0B,uEAAnB,EAAmB;AAAA,UAAfC,MAAe,uEAAN,IAAM;AAC3C,WAAKE,QAAL,CAAcL,IAAd,IAAsB,IAAID,OAAJ,CAAYC,IAAZ,EAAkBC,SAAlB,EAA6BC,IAA7B,EAAmCC,MAAnC,CAAtB;AACH;;;4BAEOH,I,EAAM;AACV,UAAI,CAAC,KAAKK,QAAL,CAAcL,IAAd,CAAL,EAA0B;AACtB,cAAM,IAAIM,KAAJ,CAAU,cAAcN,IAAd,GAAqB,aAA/B,CAAN;AACH;;AAED,UAAMO,OAAO,GAAG,KAAKF,QAAL,CAAcL,IAAd,CAAhB;;AAEA,UAAI,OAAOO,OAAO,CAACN,SAAf,KAA6B,UAAjC,EAA6C;AAEzC,YAAIM,OAAO,CAACJ,MAAR,IAAkBI,OAAO,CAACC,QAAR,KAAqB,IAA3C,EAAiD;AAC7C,iBAAOD,OAAO,CAACC,QAAf;AACH;;AAED,YAAMN,IAAI,GAAGK,OAAO,CAACL,IAArB;AACA,YAAIO,YAAY,GAAG,EAAnB;AAPyC;AAAA;AAAA;;AAAA;AAQzC,+BAAgBP,IAAhB,8HAAsB;AAAA,gBAAbQ,GAAa;AAClB,gBAAIC,WAAW,GAAG,KAAKC,OAAL,CAAaF,GAAb,CAAlB;AACAD,YAAAA,YAAY,CAACI,IAAb,CAAkBF,WAAlB;AACH;AAXwC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAYzC,YAAMV,SAAS,GAAGM,OAAO,CAACN,SAA1B;AACA,YAAMa,MAAM,GAAGC,OAAO,CAACC,SAAR,CAAkBf,SAAlB,EAA6BQ,YAA7B,CAAf;;AACA,YAAIF,OAAO,CAACJ,MAAZ,EAAoB;AAChBI,UAAAA,OAAO,CAACC,QAAR,GAAmBM,MAAnB;AACH;;AACD,eAAOA,MAAP;AACH;;AAED,aAAOP,OAAO,CAACN,SAAf;AACH","sourcesContent":["class Service {\r\n    name;\r\n    className;\r\n    shared = true;\r\n    args = [];\r\n    compiled = null;\r\n\r\n    constructor(name, className, args = [], shared = true)\r\n    {\r\n        this.shared = shared;\r\n        this.name = name;\r\n        this.className = className;\r\n        this.args = args;\r\n    }\r\n}\r\nexport default class DI {\r\n    services = {};\r\n\r\n    add(name, className, args = [], shared = true) {\r\n        this.services[name] = new Service(name, className, args, shared);\r\n    }\r\n\r\n    resolve(name) {\r\n        if (!this.services[name]) {\r\n            throw new Error(\"Service '\" + name + \"' not found\");\r\n        }\r\n\r\n        const service = this.services[name];\r\n\r\n        if (typeof service.className === 'function') {\r\n\r\n            if (service.shared && service.compiled !== null) {\r\n                return service.compiled;\r\n            }\r\n\r\n            const args = service.args;\r\n            let resolvedArgs = [];\r\n            for (let arg of args) {\r\n                let resolvedArg = this.resolve(arg);\r\n                resolvedArgs.push(resolvedArg);\r\n            }\r\n            const className = service.className;\r\n            const result = Reflect.construct(className, resolvedArgs);\r\n            if (service.shared) {\r\n                service.compiled = result;\r\n            }\r\n            return result;\r\n        }\r\n\r\n        return service.className;\r\n    }\r\n}\r\n"],"file":"index.js"}