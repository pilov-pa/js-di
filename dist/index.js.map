{"version":3,"sources":["../src/index.js"],"names":["DI","name","className","args","shared","services","hasOwnProperty","Error","Service","parameters","parameterName","service","compiled","resolvedArgs","arg","resolvedArg","indexOf","processedArgName","substring","resolve","push","result","Reflect","construct"],"mappings":"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","sourcesContent":["import Service from './Service';\r\n\r\nexport default class DI {\r\n    services = {};\r\n\r\n    parameters = {};\r\n\r\n    add(name, className, args = [], shared = true) {\r\n        if (this.services.hasOwnProperty(name)) {\r\n            throw new Error(\"Service '\" + name + \"' already exists\");\r\n        }\r\n\r\n        if (!(typeof className === 'function')) {\r\n            throw new Error(\"Parameter 'className' should be a class constructor\");\r\n        }\r\n\r\n        this.services[name] = new Service(name, className, args, shared);\r\n    }\r\n\r\n    remove(name) {\r\n        if (typeof this.services[name] === 'undefined') {\r\n            throw new Error(\"Service '\" + name + \"' not found\");\r\n        }\r\n\r\n        delete this.services[name];\r\n    }\r\n\r\n    has(name) {\r\n        return !(typeof this.services[name] === 'undefined');\r\n    }\r\n\r\n    addParameters(parameters) {\r\n        for (let parameterName in parameters) {\r\n            if (this.parameters.hasOwnProperty(parameterName)) {\r\n                throw new Error(\"Parameter '\" + parameterName + \"' already exists\");\r\n            }\r\n            this.parameters[parameterName] = parameters[parameterName];\r\n        }\r\n    }\r\n\r\n    getParameter(parameterName) {\r\n        if (!this.parameters.hasOwnProperty(parameterName)) {\r\n            throw new Error(\"Parameter '\" + parameterName + \"' not found\");\r\n        }\r\n\r\n        return this.parameters[parameterName];\r\n    }\r\n\r\n    removeParameter(parameterName) {\r\n        if (!this.parameters.hasOwnProperty(parameterName)) {\r\n            throw new Error(\"Parameter '\" + parameterName + \"' not found\");\r\n        }\r\n\r\n        delete this.parameters[parameterName];\r\n    }\r\n\r\n    resolve(name) {\r\n        if (!this.services[name]) {\r\n            throw new Error(\"Service '\" + name + \"' not found\");\r\n        }\r\n\r\n        const service = this.services[name];\r\n\r\n        if (typeof service.className === 'function') {\r\n            if (service.shared && service.compiled !== null) {\r\n                return service.compiled;\r\n            }\r\n\r\n            const args = service.args;\r\n            let resolvedArgs = [];\r\n            for (let arg of args) {\r\n                let resolvedArg;\r\n                if (arg.indexOf('@') === 0) {\r\n                    const processedArgName = arg.substring(1);\r\n\r\n                    if (!this.parameters.hasOwnProperty(processedArgName)) {\r\n                        throw new Error(\"Parameter '\" + processedArgName + \"' not found\");\r\n                    }\r\n\r\n                    resolvedArg = this.parameters[processedArgName];\r\n                } else {\r\n                    resolvedArg = this.resolve(arg);\r\n                }\r\n                resolvedArgs.push(resolvedArg);\r\n            }\r\n            const className = service.className;\r\n            const result = Reflect.construct(className, resolvedArgs);\r\n            if (service.shared) {\r\n                service.compiled = result;\r\n            }\r\n            return result;\r\n        }\r\n\r\n        return service.className;\r\n    }\r\n}\r\n"],"file":"index.js"}